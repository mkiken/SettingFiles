REPO="${HOME}/Desktop/repository/"
SET="${HOME}/Desktop/repository/SettingFiles/"

#expanded command
case "${OSTYPE}" in
# --------------- Mac(Unix) ---------------
darwin*)
MACVIM="/Applications/MacVim.app/Contents/MacOS/mvim"
# ここに設定
alias ls='ls -G'
alias la='ls -A'
alias ll='ls -AFThl'
#MacVim on CUI
alias vi='env LANG=ja_JP.UTF-8 ${MACVIM} --remote-tab-silent'
alias vs='env LANG=ja_JP.UTF-8 ${MACVIM}'
alias vimdiff='env LANG=ja_JP.UTF-8 ${MACVIM}diff'
alias pg='sudo purge'
alias ag='ag -S --stats -m 100000 --color'
alias agh='ag --hidden'

function em(){
	open -a /Applications/Emacs.app "$@"
}

function es(){
    /Applications/Emacs.app/Contents/MacOS/Emacs "$@" &
}

function ec(){
    /Applications/Emacs.app/Contents/MacOS/bin/emacsclient -n "$@" --alternate-editor /Applications/Emacs.app/Contents/MacOS/Emacs &
}

alias st='subl'
alias at='atom'

alias karabiner-export='/Applications/Karabiner.app/Contents/Library/bin/karabiner export > ${SET}mac/karabiner-setting.sh'
alias karabiner-import='sh ${SET}mac/karabiner-setting.sh'

# http://tukaikta.blog135.fc2.com/blog-entry-214.html
alias rm='rmtrash'

# 事故死予防
alias cp='cp -i'
alias mv='mv -i'

alias pv='popd'
alias up='cd ../'

alias ng='noglob'

#display all files,End with true or false
alias allfile='defaults write com.apple.finder AppleShowAllFiles'

# for server
alias ap='sudo apachectl'
alias phpini='${MACVIM} --remote-tab-silent /etc/php.ini'
alias phpini2='sudo vim /etc/php.ini'
alias cdphp='cd /Library/WebServer/Documents/'
alias cdphpl='cd /Users/${USER}/Sites'
alias httpdconf='vi /private/etc/apache2/httpd.conf'
alias httpdconf2='sudo vim /private/etc/apache2/httpd.conf'
alias -g pc='pbcopy'
alias -g pp='pbpaste'
;;

# --------------- Linux ---------------
linux*)
# ここに設定
alias ls='ls --color=auto'
function vi(){
	gvim -f --remote-tab-silent $@ &
}
# function vi(){
# gvim -f --remote-tab $1 &
# }
function es(){
	emacs $@ &
}
function ec(){
	emacsclient $@ --alternate-editor emacs &
}
;;
esac

# --------------- 共通設定 ---------------

#make new alias
#alias refresh='source ~/.bashrc'
alias refresh='source ~/.zshrc;echo "zshrc reloaded.";source ~/.zshenv;echo "zshenv reloaded."'

alias pyserv='python -m SimpleHTTPServer'

alias l='ls'
alias le='less'

#cd
alias cdp='cd ~/Program/ProCon'
alias cdd='cd ~/Desktop'
alias cdr='cd ${REPO}'
alias cds='cd ${SET}'

#shortcut for setting files
alias bashrc='vi ~/.bashrc'
alias zshrc='vi ~/.zshrc'
alias aliases='vi ~/.aliases'
alias einit='vi ~/.emacs.d/init.el'
# alias vimrc='vi ~/.vimrc'
alias vimrc='vi ~/.vimrc'
alias gvimrc='vi ~/.gvimrc'
alias gitconfig='vi ~/.gitconfig'
alias zshenv='vi ~/.zshenv'
alias jshintrc='vi ~/.jshintrc'
alias jsbeautifyrc='vi ~/.jsbeautifyrc'
alias editorconfig='vi ~/.editorconfig'
alias tmuxconf='vi ~/.tmux.conf'
alias macinit='vi ${SET}/mac/initialize'
alias macupdate='vi ${SET}/mac/update'
alias tigrc='vi ~/.tigrc'
alias phpsnip='vi ~/.vim/snippets/php.snip'

#shortcut for git
alias g='noglob git'
alias gs='git s'
alias ga='git add'
alias gaa='git add .'
# alias gra='git rmall'
alias gcm='git commit -m'
alias gci='git commit'
alias gca='git commit --amend'
alias gps='git push'
alias gps-dry-run='git push -n'
# alias gpl='git current-branch | git pull origin'
alias gd='git diff'
alias gmd='git modified'
alias gdc='git diff --cached'
alias gad='git added'
alias gdel='git deleted'
alias gpl-dry-run='git pull-dry-run'
alias gcb='git current-branch'
alias grb='git rb'
alias grba='git rb --abort'
alias grbc='git rb --continue'
alias grbi='git rb -i'
alias gdfw='git wdf'
alias gtr='git tree'
alias gl='git log'
alias ggr='git gr'
alias glg='git lg'
alias ghb='git hisback'
alias gb='git branch'
alias gft='git fetch'
alias gvdf='git vdf'
alias gvmd='git vmodified'
alias gco='git co'
alias gst='git st'
alias glst='gl --stat'
alias gln='gl --name-only'
alias glns='gl --name-status'
alias glp='gl -p'
alias gcl='git clean'
alias gmg='git merge'
alias gmgs='git merge --squash'
alias gcob='gco -b'
alias gba='gb -a'
alias gstd='gst drop'
alias gstp='gst pop'
alias gshs='gst show stash'
alias gsts='gst show stash'
alias gl1='gl --oneline'
alias gmv='g mv'
alias grm='g rm'
alias gbrsync='git fetch --prune'
# alias gprb='g pl --rebase'
alias gr0='g r0'
# alias gbd='gb -d'
alias gcl='g cl'
alias gsuu='g s -s | grep "UU"'
alias gsa='g s -s | grep "A"'
alias gsm='g s -s | grep "M"'
alias gsd='g s -s | grep "D"'
alias gcoo='gco --ours'
alias gcot='gco --theirs'
alias gac='git add reset HEAD'
alias gbd='gb -d'
alias gbD='gb -D'
alias gdn='gd --name-status'
alias gdp='ng git diff HEAD^ HEAD'

function lessc(){
  less | /usr/local/bin/src-hilite-lesspipe.sh $1
}

function gbl(){
  g bl $@ | gsed -f "${SET}sedfiles/colorize_git_blame.sed" | less
}

function tflog(){
  tail -f $@ | gsed -f "${SET}sedfiles/colorize_log.sed"
}

function gsync(){
  git pull
  git smupdate
}

function gpl(){
  branch=`g current-branch`
  remote=`g remote`
  g pl "${remote}" "${branch}"
}

function gdfb(){
  branch=`g current-branch`
  g df $1 "${branch}" $2
}

function gprb(){
  branch=`g current-branch`
  remote=`g remote`
  g pl --rebase "${remote}" "${branch}"
}

function gbm(){
  branch=`g current-branch`
  gb -m "${branch}" $@
}

#shortcut for Application
alias e='./a.out'
# alias cot='open -a CotEditor'
# alias aq='aquamacs'
alias ccp='noglob ccp'

alias zmv='noglob zmv -W'
alias zcp='zmv -C'

alias vd='vimdiff'

#rlwrap
# alias ocaml='rlwrap ocaml'


# util
alias sz='du -ch -d 1'

# tmux
alias t='tmux'
alias ta='t a -t'
alias tn='t new'
alias tc='t new -s'
alias tm='tmux rename-session -t'
alias tk='t kill-session -t'
alias tks='t kill-server'
alias tss='t start-server'

# 現在のディレクトリ以下の当てはまるファイルを全て削除する
# http://www.omnioo.com/omnioolab/2012/07/find.php
alias rrm='noglob _rrm'
function _rrm(){
  opt=""
  rmopt=""
  while getopts "i" flag; do
    case $flag in
      \?) arg+=$flag; break;;
      i) opt+="i";rmopt+="i";;
    esac
  done
  shift $(( $OPTIND - 1 ))

  find -L . "-${opt}name" "*${@}*"
  echo "remove all above? [y/N]"
  read ANSWER
  case $ANSWER in
      "Y" | "y" | "yes" | "Yes" | "YES" )
          find -L . "-${opt}name" "*${@}*" -exec rm "-r${rmopt}" {} \;;
          echo "$@ removed recursively.";;
      * ) echo "rrm canceled.";;
  esac
}

alias rfind='noglob _rfind'
# 現在のディレクトリ以下から引数の文字列を含むファイル名を列挙
function _rfind(){
  opt=""
  while getopts "i" flag; do
    case $flag in
      \?) arg+=$flag; break;;
      i) opt+="i";;
    esac
  done
  shift $(( $OPTIND - 1 ))
  find -L . "-${opt}name" "*${@}*"
}

# 現在のディレクトリ以下から引数の文字列を列挙
alias rgrep='noglob _rgrep'
function _rgrep(){
  opt=""
  while getopts "Eciwx" flag; do
    case $flag in
      \?) arg+=$flag; break;;
      E) opt+="E";;
      c) opt+="c";;
      i) opt+="i";;
      w) opt+="w";;
      x) opt+="x";;
    esac
  done
  shift $(( $OPTIND - 1 ))
  grep "-nr${opt}" "${@}" *
}


# Haskellのファイルをa.outでコンパイルする
# その際、オブジェクトファイル(.o)とインターフェースファイル(.hi)を削除
function ghca(){
    ghc $1 -o a.out
        ret=$?
        if test ${ret} -eq 0
            then
                fname=`echo $1 | sed -e "s/\.[^.]*$//"`
                rm ${fname}.hi
                rm ${fname}.o
                fi
}

# http://blog.repl.info/2011/12/03/ssh-with-tmux-and-zsh/
# tmuxの中でmanを実行した場合，新しくペインを作成する
function sp-man() {
  eval server=\${$#}
  tmux split-window "exec man $@"
}

function sp-gs() {
  eval server=\${$#}
  tmux split-window "exec git s | less"
}

function sp-gmd() {
  eval server=\${$#}
  tmux split-window "exec git modified"
}

function sp-ag() {
  eval server=\${$#}
  tmux split-window "exec ag -S --stats -m 100000 --color $@ | less"
}

function sp-find() {
  eval server=\${$#}
  tmux split-window "exec find $@ | less"
}

function sp-tig() {
  eval server=\${$#}
  tmux split-window "exec tig"
}
