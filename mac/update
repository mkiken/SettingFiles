#!/bin/zsh

REPO="${HOME}/Desktop/repository/"
SET="${REPO}SettingFiles/"
SUBMODULE_DIR="${SET}submodules/"

source "$(dirname "$0")/scripts/common.sh"

smart_copy ~/.config/karabiner/karabiner.json "${SET}mac/karabiner.json"
smart_copy ~/Library/Application\ Support/Code/User/settings.json "${Repo}vscode/base_setting.json"
smart_copy ~/Library/Application\ Support/Code/User/keybindings.json "${Repo}vscode/base_keybindings.json"

echo "start git submodule setting."
git submodule sync
git submodule update --recursive --remote
echo "end git submodule setting."

echo "start brew update."
brew update -v
brew upgrade -v
brew cleanup -s
brew bundle -v
echo "end brew update."



npm update -g

pipx upgrade-all -v

# AI tools更新
echo "start AI tools update."
source "$(dirname "$0")/updates/ai_tools.sh"
echo "end AI tools update."

# Lazy + tree-sitterのアップデート
nvim --headless "+Lazy! sync | TSUpdate" +qa

source ${SUBMODULE_DIR}/zsh-snap/znap.zsh  # Start Znap
znap pull

gh extension upgrade --all

zcompile ~/.zshrc
