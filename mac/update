#!/bin/zsh

REPO="${HOME}/Desktop/repository/"
SET="${REPO}SettingFiles/"
SUBMODULE_DIR="${SET}submodules/"

echo "start git submodule setting."
git submodule sync
git submodule update --recursive --remote
echo "end git submodule setting."

echo "start brew update."
brew update -v
brew upgrade -v
brew cleanup -s
brew bundle -v
echo "end brew update."

npm update -g

# Geminiのシンボリックリンクチェック
if [[ -f "${SET}mac/scripts/check_gemini_symlink.sh" ]]; then
    source "${SET}mac/scripts/check_gemini_symlink.sh"
else
    echo "⚠️  Gemini symlink check script not found"
fi

# for Claude
SuperClaude update --verbose --yes

# Lazy + tree-sitterのアップデート
nvim --headless "+Lazy! sync | TSUpdate" +qa

source ${SUBMODULE_DIR}/zsh-snap/znap.zsh  # Start Znap
znap pull

gh extension upgrade --all --yes

# p10kのファイルはシンボリックリンクにできないので、更新されてたらここで更新をリポジトリに取り込む
cp -i ~/.p10k.zsh  ${SET}shell/zsh/p10k

zcompile ~/.zshrc
